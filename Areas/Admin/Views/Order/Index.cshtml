



@model IEnumerable<JDshop.Models.Order>

@{
    ViewData["Title"] = "Đơn hàng chờ xác nhận";
}

<div class="container-fluid" style="background-color: #f8f9fa; min-height: 100vh; padding: 24px;">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="fw-bold text-dark mb-1">
                <i class="fas fa-clock me-2"></i>Quản lý đơn hàng chờ xác nhận
            </h4>
            <p class="text-muted mb-0">Quản lý thông tin và trạng thái đơn hàng chờ xác nhận</p>
        </div>
        <button class="btn btn-success rounded-pill px-4">
            <i class="fas fa-plus me-2"></i>Tạo đơn hàng
        </button>
    </div>

    <!-- Statistics Cards -->
    <div class="row mb-4">
        <div class="col-md-3 mb-3">
            <div class="card border-0 shadow-sm h-100" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <div class="card-body text-white">
                    <div class="d-flex align-items-center">
                        <div class="rounded-3 p-3 me-3" style="background: rgba(255,255,255,0.2);">
                            <i class="fas fa-shopping-cart fa-lg"></i>
                        </div>
                        <div>
                            <h3 class="mb-0 fw-bold">@Model.Count()</h3>
                            <p class="mb-0 opacity-75">Chờ xác nhận</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card border-0 shadow-sm h-100" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                <div class="card-body text-white">
                    <div class="d-flex align-items-center">
                        <div class="rounded-3 p-3 me-3" style="background: rgba(255,255,255,0.2);">
                            <i class="fas fa-money-bill-wave fa-lg"></i>
                        </div>
                        <div>
                            <h3 class="mb-0 fw-bold">@string.Format("{0:N0}", Model.Sum(x => x.Total))</h3>
                            <p class="mb-0 opacity-75">Tổng giá trị</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card border-0 shadow-sm h-100" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <div class="card-body text-white">
                    <div class="d-flex align-items-center">
                        <div class="rounded-3 p-3 me-3" style="background: rgba(255,255,255,0.2);">
                            <i class="fas fa-chart-line fa-lg"></i>
                        </div>
                        <div>
                            <h3 class="mb-0 fw-bold">@string.Format("{0:N0}", Model.Any() ? Model.Average(x => x.Total) : 0)</h3>
                            <p class="mb-0 opacity-75">Giá trị TB</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card border-0 shadow-sm h-100" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                <div class="card-body text-white">
                    <div class="d-flex align-items-center">
                        <div class="rounded-3 p-3 me-3" style="background: rgba(255,255,255,0.2);">
                            <i class="fas fa-calendar-day fa-lg"></i>
                        </div>
                        <div>
                            <h3 class="mb-0 fw-bold">@Model.Where(x => x.CreateDay.HasValue && x.CreateDay.Value.Date == DateTime.Today).Count()</h3>
                            <p class="mb-0 opacity-75">Hôm nay</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Table Section -->
    <div class="card border-0 shadow-sm">
        <div class="card-body p-0">
            <!-- Table Header -->
            <div class="p-4 border-bottom">
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="mb-0 fw-bold">
                        <i class="fas fa-list me-2"></i>Danh sách đơn hàng
                    </h5>
                    <div class="d-flex gap-2">
                        <div class="position-relative">
                            <input type="text" class="form-control rounded-pill ps-5" placeholder="Tìm kiếm đơn hàng..." style="width: 300px;">
                            <i class="fas fa-search position-absolute top-50 start-0 translate-middle-y ms-3 text-muted"></i>
                        </div>
                        <select class="form-select rounded-pill" style="width: auto;">
                            <option>Tất cả trạng thái</option>
                            <option>Chờ xác nhận</option>
                        </select>
                        <select class="form-select rounded-pill" style="width: auto;">
                            <option>Tất cả thời gian</option>
                            <option>Hôm nay</option>
                            <option>7 ngày qua</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Table -->
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead style="background-color: #f8f9fa;">
                        <tr>
                            <th class="border-0 py-3 ps-4">Thông tin cá nhân</th>
                            <th class="border-0 py-3">Tài khoản</th>
                            <th class="border-0 py-3">Liên hệ</th>
                            <th class="border-0 py-3">Giá trị</th>
                            <th class="border-0 py-3">Ngày đặt</th>
                            <th class="border-0 py-3">Trạng thái</th>
                            <th class="border-0 py-3 text-center">Thao tác</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td class="ps-4 py-3">
                                    <div class="d-flex align-items-center">
                                        <div class="rounded-circle d-flex align-items-center justify-content-center me-3"
                                             style="width: 40px; height: 40px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: bold;">
                                            @(item.Account?.FullName?.Substring(0, 1).ToUpper() ?? "U")
                                        </div>
                                        <div>
                                            <div class="fw-semibold">@item.Account?.FullName</div>
                                            <div class="text-muted small">
                                                <i class="fas fa-calendar me-1"></i>
                                                @(item.CreateDay.HasValue ? item.CreateDay.Value.ToString("dd/MM/yyyy") : "")
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td class="py-3">
                                    <span class="fw-semibold">#@item.Id</span>
                                </td>
                                <td class="py-3">
                                    <div>
                                        <div class="small">
                                            <i class="fas fa-envelope me-1 text-muted"></i>@item.Account?.Email
                                        </div>
                                        <div class="small">
                                            <i class="fas fa-phone me-1 text-muted"></i>@item.Account?.Phone
                                        </div>
                                    </div>
                                </td>
                                <td class="py-3">
                                    <span class="fw-bold text-primary">@string.Format("{0:N0}", item.Total) đ</span>
                                </td>
                                <td class="py-3">
                                    @(item.CreateDay.HasValue ? item.CreateDay.Value.ToString("dd/MM/yyyy") : "")
                                </td>
                                <td class="py-3">
                                    <span class="badge bg-warning text-dark rounded-pill">
                                        <i class="fas fa-clock me-1"></i>Chờ xác nhận
                                    </span>
                                </td>
                                <td class="py-3 text-center">
                                    <div class="d-flex justify-content-center gap-1">
                                        <button class="btn btn-sm btn-outline-primary rounded-circle" style="width: 32px; height: 32px;" title="Xem chi tiết">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <a asp-action="ConfimOrder" asp-route-id="@item?.Id" class="btn btn-sm btn-outline-success rounded-circle" style="width: 32px; height: 32px;" title="Xác nhận">
                                            <i class="fas fa-check"></i>
                                        </a>
                                        <a asp-action="CanOrderby" asp-route-id="@item?.Id" class="btn btn-sm btn-outline-danger rounded-circle" style="width: 32px; height: 32px;" title="Hủy đơn">
                                            <i class="fas fa-times"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
